<div class="user-form-container">
  <h2>Añadir usuario</h2>
  <form [formGroup]="userForm" (ngSubmit)="guardarUsuario()">
    <div class="form-field">
      <label for="name">Nombre</label>
      <input
        type="text"
        id="name"
        formControlName="name"
        [ngClass]="{
          'input-invalid': userForm.controls['name'].invalid && userForm.controls['name'].touched
        }"
      />
      <div class="error-message" *ngIf="userForm.controls['name'].invalid && userForm.controls['name'].touched">
        <small>El nombre es obligatorio.</small>
      </div>
    </div>

    <div class="form-field">
      <label for="email">Correo</label>
<input
        type="email"
        id="email"
        formControlName="email"
        [ngClass]="{
          'input-invalid': userForm.controls['email'].invalid && userForm.controls['email'].touched
        }"
      />
      <div class="error-message" *ngIf="userForm.controls['email'].invalid && userForm.controls['email'].touched">
        <small *ngIf="userForm.controls['email'].errors?.['required']">El correo es obligatorio.</small>
        <small *ngIf="userForm.controls['email'].errors?.['email'] || userForm.controls['email'].errors?.['pattern']">
          Introduzca una dirección de correo válida
        </small>
        <small *ngIf="userForm.controls['email'].errors?.['duplicate']">
          El correo ya existe: {{ userForm.controls['email'].value }}
        </small>
      </div>
    </div>

    <div class="form-field password-wrapper">
      <label for="password">Contraseña</label>
      <div class="password-container">
        <input
          [type]="mostrarPassword ? 'text' : 'password'"
          id="password"
          formControlName="password"
          [ngClass]="{
            'input-invalid': userForm.controls['password'].invalid && userForm.controls['password'].touched
          }"
        />
        <button type="button" class="toggle-password" (click)="mostrarPassword = !mostrarPassword">
          <img src="assets/img/login_eye.svg" class="icon eye" alt="Mostrar/Ocultar">
        </button>
      </div>
      <div class="error-message" *ngIf="userForm.controls['password'].invalid && userForm.controls['password'].touched">
        <small *ngIf="userForm.controls['password'].errors?.['required']">La contraseña es obligatoria.</small>
        <small *ngIf="userForm.controls['password'].errors?.['minlength']">Debe tener al menos 6 caracteres.</small>
        <small *ngIf="userForm.controls['password'].errors?.['maxlength']">No debe superar los 50 caracteres.</small>
      </div>
    </div>


    <div class="form-field">
      <label for="role">Rol</label>
        <select
          id="role"
          formControlName="role"
          [ngClass]="{
            'input-invalid': userForm.controls['role'].invalid && userForm.controls['role'].touched
          }"
        >
        <option [value]="'ADMIN'">Administrador</option>
        <option [value]="'COLLABORATOR'">Analista</option>
      </select>
        <div class="error-message" *ngIf="userForm.controls['role'].invalid && userForm.controls['role'].touched">
        <small>Debe seleccionar un rol.</small>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn-cancel" (click)="cancelar()">Cancelar</button>
      <button type="submit" class="btn-submit">Aceptar</button>
    </div>
  </form>
</div>
